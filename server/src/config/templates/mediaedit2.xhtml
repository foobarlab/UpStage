<!include master_a.inc>
<!include workshop_nav.inc>

<!-- TODO instead of using master_a.inc (containing all scripts and styles) setup own head for this page? -->

<script type="text/javascript">document.title='Workshop - Media'; </script>

<!-- include slickgrid -->
<script type="text/javascript" src="/script/slickgrid/lib/jquery-1.7.min.js"></script>
<script type="text/javascript" src="/script/slickgrid/lib/jquery.event.drag-2.0.min.js"></script>
<script type="text/javascript" src="/script/slickgrid/slick.core.js"></script>
<script type="text/javascript" src="/script/slickgrid/slick.grid.js"></script>
<script type="text/javascript" src="/script/slickgrid/plugins/slick.rowselectionmodel.js"></script>

<!-- include jquery.easytabs -->
<script type="text/javascript" src="/script/jquery.easytabs/jquery.hashchange.min.js"></script>
<script type="text/javascript" src="/script/jquery.easytabs/jquery.easytabs.min.js"></script>

<!-- include various third party libs -->
<!-- 
<script type="text/javascript" src="/script/swfobject/swfobject.js"></script>
-->
<script type="text/javascript" src="/script/jquery.swfobject/jquery.swfobject.1-1-1.js"></script>
<script type="text/javascript" src="/script/spin.js/spin.js"></script>
<script type="text/javascript" src="/script/jquery.spin.js/jquery.spin.js"></script>
<script type="text/javascript" src="/script/jquery.colorbox/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="/script/jquery.multiselect/jquery.multi-select.js"></script>
<script type="text/javascript" src="/script/chosen/chosen.jquery.min.js"></script>


<h1 style="margin:20px 0">Edit/View Media</h1>

<div id="filterDiv">

	<div class="filterRow">
	
		<p class="filterTitle">Filter:</p>
		
		<div class="filterBlock">
			<label for="filterUser">User:</label>
			<select id="filterUser" name="filterUser" style="width:150px">
				<option value=""></option>
				%(list_users_as_html_option_tag)s
			</select>
		</div>
		
		<div class="filterBlock">
			<label for="filterStage">Stage:</label>
			<select id="filterStage" name="filterStage" style="width:150px">
				<option value=""></option>
				<option value="^"> -- not assigned -- </option><!-- dummy char '^' used for unassigned stages, see pages.py -->
				%(list_stages_as_html_option_tag)s
			</select>
		</div>
		
		<div class="filterBlock">
			<label for="filterType">Type:</label>
			<select id="filterType" name="filterType" style="width:100px">
				<option value=""></option>
				<option value="avatar">Avatar</option>
				<option value="prop">Prop</option>
				<option value="backdrop">Backdrop</option>
				<option value="audio">Audio</option>
			</select>
		</div>
			
		<div class="filterBlock">
			<label for="filterMedium">Medium:</label>
			<select id="filterMedium" name="filterMedium" style="width:100px">
				<option value=""></option>
				<option value="stream">Stream</option>
				<option value="video">Video</option>
				<option value="music">Music</option>
				<option value="sfx">Sound-Effect</option>
			</select>
		</div>
	
		<div class="filterBlock">
		    <input id="buttonUpdateView" type="button" style="width:100px" value="Apply Filter" />
	    	<input id="buttonResetView" type="button" style="width:60px" value="Reset" />
	 	</div>
	 
	</div>
    
</div>

<hr />

<div id="viewPanel">

	<div id="dataPanel">
	
		<!-- TODO SlickGrid Live Update, Clear Button -->
		
		<div class="filterRow">
	
			<p class="filterTitle">Quick Search:</p>
	
			<div class="filterBlock">
				<label for="filterName">Name:</label>
				<input type="text" size="20" id="filterName" name="filterName" />
			</div>
			
			<div class="filterBlock">
				<label for="filterTags">Tags:</label>
				<input type="text" size="20" id="filterTags" name="filterTags" />
	 		</div>
	 		
	 		<div class="filterBlock">
		    	<input id="buttonClearQuickSearch" type="button" style="width:60px" value="Clear" />
	 		</div>
	 
		</div>
	
		<div id="dataGrid"></div>
		
		<div id="dataSummary">
			<p><span id="infoTotalMediaCount">0</span> media entries &ndash; total <span id="infoTotalMediaSize">0 Bytes</span></p>
		</div>
		
		<div id="dataLoadingPanel">
			<div id="dataLoadingPanelInnerDiv">
				<div id="spinner"></div>
				<p style="font-weight:bold">Loading data ...</p>
			</div>
		</div>
		
	</div>
	
	<div id="detailsPanel">
		
		<div id="controlButtons" class="buttonRow">
			<button id="buttonPreviewMedia" type="button" title="Preview" class="controlButton"><i class="icon-eye-open icon-2x"></i></button>
			<button id="buttonEditMedia" type="button" title="Edit" class="controlButton"><i class="icon-pencil icon-2x"></i></button>
			<button id="buttonAssignMedia" type="button" title="Assign" class="controlButton"><i class="icon-link icon-2x"></i></button>
			<button id="buttonTagMedia" type="button" title="Tag" class="controlButton"><i class="icon-tag icon-2x"></i></button>
			<button id="buttonDownloadMedia" type="button" title="Download" class="controlButton"><i class="icon-download-alt icon-2x"></i></button>
			<button id="buttonDeleteMedia" type="button" title="Delete" class="controlButton"><i class="icon-trash icon-2x"></i></button>
		</div>
		
		<h4 id="displayName"></h4>
		
		<div id="thumbnailPreview"></div>
		
		<table id="tableDetails">
		
			<tr>
				<td class="head">Type:</td>
				<td><div id="detailType" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">File:</td>
				<td><div id="detailFile" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">Size:</td>
				<td><div id="detailSize" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">Date:</td>
				<td><div id="detailDate" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">User:</td>
				<td><div id="detailUser" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">Voice:</td>
				<td><div id="detailVoice" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">Tags:</td>
				<td><div id="detailTags" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">Stages:</td>
				<td><div id="detailStages" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">Streamserver:</td>
				<td><div id="detailStreamserver" class="detail"></div></td>
			</tr>
			<tr>
				<td class="head">Streamname:</td>
				<td><div id="detailStreamname" class="detail"></div></td>
			</tr>
			
		</table>
		
	</div>

</div>

<!-- colorbox inline divs, hidden by default -->

<div style="display:none">

	<div id="previewMediaPanel" class="colorboxPanel">
		<div class="dialogContent">
		
			<h1>Preview &quot;<span id="previewMediaName"></span>&quot;</h1>
			
			<div id="previewTabsContainer" class="tab-container">
			
				<ul class="easytabs">
					<li id="tabPreviewImage" class="tab"><a href="#panelPreviewImage">Image</a></li>
					<li id="tabPreviewAudio" class="tab"><a href="#panelPreviewAudio">Audio</a></li>
					<li id="tabPreviewFlash" class="tab"><a href="#panelPreviewFlash">Flash</a></li>
					<li id="tabPreviewStream" class="tab"><a href="#panelPreviewStream">Stream</a></li>
					<li id="tabPreviewThumbnail" class="tab"><a href="#panelPreviewThumbnail">Thumbnail</a></li>
				</ul>

				<div id="panelPreviewThumbnail">
					<p>THUMBNAIL PREVIEW</p>
				</div>

				<div id="panelPreviewImage">
					<p>IMAGE PREVIEW</p>
				</div>
				
				<div id="panelPreviewAudio">
					<p>AUDIO PREVIEW</p>
				</div>
				
				<div id="panelPreviewStream">
					<p>STREAM PREVIEW</p>
				</div>
				
				<div id="panelPreviewFlash">
					<p>FLASH PREVIEW</p>
				</div>
				
			</div>
			
		</div>
	</div>
	
	<div id="assignMediaPanel" class="colorboxPanel">
	
		<div class="dialogContent">
			<h1>Assign &quot;<span id="assignMediaName"></span>&quot; to stages</h1>
			
			<div id="assignMediaToStageSelectorPanel"></div>
			
			<p class="dialogNote"><strong>Note:</strong> Changes will force a reload only of the newly assigned and unassigned stages</p>
			
			<div class="dialogButtonRow">
				<input type="button" style="width:100px" id="buttonCancelAssign" value="Cancel" />
				<input type="button" style="width:100px" id="buttonExecuteAssign" value="Apply" />
			</div>
		
		</div>
		
		<script type="text/javascript">
			// default close function for cancel button
			$("#buttonCancelAssign").click(function(){ $.fn.colorbox.close(); return false; });
		</script>

	</div>
	
	<div id="tagMediaPanel" class="colorboxPanel">
		
		<div class="dialogContent">
			<h1>Set Tags for &quot;<span id="tagMediaName"></span>&quot;</h1>
			
			<div id="tagMediaSelectorPanel"></div>
			
			<div class="dialogButtonRow">
				<input type="button" style="width:100px" id="buttonCancelTag" value="Cancel" />
				<input type="button" style="width:100px" id="buttonExecuteTag" value="Apply" />
			</div>
			
		</div>
		
		<script type="text/javascript">
			// default close function for cancel button
			$("#buttonCancelTag").click(function(){ $.fn.colorbox.close(); return false; });
		</script>

	</div>

	<div id="editMediaPanel" class="colorboxPanel">
		<div class="dialogContent">
			<div id="editPanelAvatar">
				<p>EDIT AVATAR</p>
				<ul>
					<li>Name</li>
					<li>Voice</li>
					<li>Streamserver (if medium = stream)</li>
					<li>Streamname (if medium = stream)</li>
					<li>Image (if medium = video)</li>
				</ul>
			</div>
			
			<div id="editPanelProp">
				<p>EDIT PROP</p>
				<ul>
					<li>Name</li>
				</ul>
			</div>
			
			<div id="editPanelBackdrop">
				<p>EDIT BACKDROP</p>
				<ul>
					<li>Name</li>
				</ul>
			</div>
			
			<div id="editPanelAudio">
				<p>EDIT AUDIO</p>
				<ul>
					<li>Name</li>
					<li>Audio Type</li>
				</ul>
			</div>
			
			<div id="editPanelVideo">
				<p>EDIT VIDEO AVATAR</p>
				<ul>
					<li>Name</li>
				</ul>
			</div>
		</div>
		
	</div>

	<div id="deleteMediaPanel" class="colorboxPanel">
	
		<div class="dialogContent">
			<h1>Delete &quot;<span id="deleteMediaName"></span>&quot;?</h1>
			<div id="deleteEvenIfInUseDisplay">
				<p>Assigned to <strong><span id="deleteMediaAssignedStages"></span></strong>.</p>
				<input type="checkbox" name="deleteEvenIfInUse" id="deleteEvenIfInUse" />
				<label for="deleteEvenIfInUse">confirm to delete from all assigned stages <em>(forces stage reload)</em></label>
			</div>
			
			<div class="dialogButtonRow">
				<input type="button" style="width:100px" id="buttonCancelDelete" value="Cancel" />
				<input type="button" style="width:100px" id="buttonExecuteDelete" value="Delete" />
			</div>	
		
		</div>
		
		<script type="text/javascript">
			// default close function for cancel button
			$("#buttonCancelDelete").click(function(){ $.fn.colorbox.close(); return false; });
		</script>
		
	</div>
	
	<div id="errorPanel" class="colorboxPanel colorboxErrorPanel">
		
		<div class="dialogContent errorContent">
			<h1><span id="errorTitle"></span></h1>
			<span id="errorMessage"></span>
		
			<div class="dialogButtonRow">
				<input type="button" style="width:100px" id="buttonErrorClose" value="Close" />
			</div>
		
		</div>
		
		<script type="text/javascript">
			// default close function for close button
			$("#buttonErrorClose").click(function(){ $.fn.colorbox.close(); return false; });
		</script>
	
	</div>
	
</div>

<!-- TODO: #89: dynamically add iframe for "downoad media" instead of hardcoding here (problem: empty 'src' attribute) -->
<iframe id="downloadIFrame" src="" style="display:none; visibility:hidden;"></iframe>

<script type="text/javascript">
var stageList = %(list_stages_as_json)s;
$(document).ready(function(){
	setupMediaEdit2("%(req:path)s","%(user)s",stageList,true);
})
</script>

<!include master_b.inc>